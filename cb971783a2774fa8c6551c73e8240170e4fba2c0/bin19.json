{"a58284bd761e79180eaebfc8691241b8758d82ab": "{\"params\":{\"model\":\"o4-mini\",\"n\":1,\"num_candidates_per_completion\":1,\"insufficient_valids_behaviour\":\"retry\",\"temperature\":1.0,\"top_p\":null,\"max_tokens\":5000,\"thinking\":null,\"logprobs\":null,\"seed\":null,\"logit_bias\":null,\"stop\":null,\"unknown_kwargs\":{}},\"prompt\":{\"messages\":[{\"role\":\"system\",\"content\":\"Please solve this Codeforces problem by writing a Python solution. Return only the code and nothing else.\"},{\"role\":\"user\",\"content\":\"Problem: In the fourth labor of Rostam, the legendary hero from the Shahnameh, an old witch has created a magical maze to trap him. The maze is a rectangular grid consisting of $$$n$$$ rows and $$$m$$$ columns. Each cell in the maze points in a specific direction: up, down, left, or right. The witch has enchanted Rostam so that whenever he is in a cell, he will move to the next cell in the direction indicated by that cell.\\n\\nIf Rostam eventually exits the maze, he will be freed from the witch's enchantment and will defeat her. However, if he remains trapped within the maze forever, he will never escape.\\n\\nThe witch has not yet determined the directions for all the cells. She wants to assign directions to the unspecified cells in such a way that the number of starting cells from which Rostam will be trapped forever is maximized. Your task is to find the maximum number of starting cells which make Rostam trapped.\\n\\nTest Case Format:\\nThe first line of the input contains an integer $$$t$$$ ($$$1 \\\\leq t \\\\leq 10^4$$$), the number of test cases.\\n\\nFor each test case:\\n\\n- The first line contains two integers $$$n$$$ and $$$m$$$ ($$$1 \\\\leq n, m \\\\leq 1000$$$), representing the number of rows and columns in the maze.\\n- Each of the next $$$n$$$ lines contains a string of $$$m$$$ characters representing the directions in the maze. Each character is one of the following:   U (up)  D (down)  L (left)  R (right)  ? (unspecified direction)\\n\\nIt's guaranteed that the sum of $$$n \\\\cdot m$$$ over all test cases is at most $$$10^6$$$.\\n\\nFor each test case, print a single integer, the maximum number of starting cells from which Rostam will be trapped forever after assigning directions to the unspecified cells optimally.\\n\\nTest Inputs:\\n3\\r\\n3 3\\r\\nUUU\\r\\nL?R\\r\\nDDD\\r\\n2 3\\r\\n???\\r\\n???\\r\\n3 3\\r\\n?U?\\r\\nR?L\\r\\nRDL\\r\\n\\n\\nTest Outputs:\\n0\\r\\n6\\r\\n5\\r\\n\"}]},\"responses\":[{\"model_id\":\"o4-mini\",\"completion\":\"\",\"stop_reason\":\"max_tokens\",\"cost\":0.0005434,\"audio_out\":null,\"duration\":35.700486183166504,\"api_duration\":35.59964203834534,\"logprobs\":null,\"safety_ratings\":null,\"recitation_retries\":null,\"api_failures\":1,\"batch_custom_id\":null,\"reasoning_content\":null,\"usage\":{\"input_tokens\":494,\"output_tokens\":5000,\"total_tokens\":5494,\"prompt_tokens_details\":{\"audio_tokens\":0,\"cached_tokens\":0},\"completion_tokens_details\":{\"accepted_prediction_tokens\":0,\"audio_tokens\":0,\"reasoning_tokens\":5000,\"rejected_prediction_tokens\":0}}}]}", "d6597ec4d99119067beff0f79d4a131709f769b7": "{\"params\":{\"model\":\"o4-mini\",\"n\":1,\"num_candidates_per_completion\":1,\"insufficient_valids_behaviour\":\"retry\",\"temperature\":1.0,\"top_p\":null,\"max_tokens\":5000,\"thinking\":null,\"logprobs\":null,\"seed\":null,\"logit_bias\":null,\"stop\":null,\"unknown_kwargs\":{}},\"prompt\":{\"messages\":[{\"role\":\"system\",\"content\":\"Please solve this Codeforces problem by writing a Python solution. Return only the code and nothing else.\"},{\"role\":\"user\",\"content\":\"Problem: This is an interactive problem.\\n\\nMisuki has chosen a secret tree with $$$n$$$ nodes, indexed from $$$1$$$ to $$$n$$$, and asked you to guess it by using queries of the following type:\\n\\n- \\\"? a b\\\"\u00a0\u2014 Misuki will tell you which node $$$x$$$ minimizes $$$|d(a,x) - d(b,x)|$$$, where $$$d(x,y)$$$ is the distance between nodes $$$x$$$ and $$$y$$$. If more than one such node exists, Misuki will tell you the one which minimizes $$$d(a,x)$$$.\\n\\nFind out the structure of Misuki's secret tree using at most $$$15n$$$ queries!\\n\\nTest Case Format:\\nEach test consists of multiple test cases. The first line contains a single integer $$$t$$$ ($$$1 \\\\le t \\\\le 200$$$)\u00a0\u2014 the number of test cases.\\n\\nEach test case consists of a single line with an integer $$$n$$$ ($$$2 \\\\le n \\\\le 1000$$$), the number of nodes in the tree.\\n\\nIt is guaranteed that the sum of $$$n$$$ across all test cases does not exceed $$$1000$$$.\\n\\nNone\\n\\nTest Inputs:\\n1\\r\\n4\\r\\n1 2\\r\\n1 3\\r\\n3 4\\r\\n\\n\\nTest Outputs:\\n5\\r\\n\"}]},\"responses\":[{\"model_id\":\"o4-mini\",\"completion\":\"\",\"stop_reason\":\"max_tokens\",\"cost\":0.0003388,\"audio_out\":null,\"duration\":45.94963312149048,\"api_duration\":45.85435914993286,\"logprobs\":null,\"safety_ratings\":null,\"recitation_retries\":null,\"api_failures\":2,\"batch_custom_id\":null,\"reasoning_content\":null,\"usage\":{\"input_tokens\":308,\"output_tokens\":5000,\"total_tokens\":5308,\"prompt_tokens_details\":{\"audio_tokens\":0,\"cached_tokens\":0},\"completion_tokens_details\":{\"accepted_prediction_tokens\":0,\"audio_tokens\":0,\"reasoning_tokens\":5000,\"rejected_prediction_tokens\":0}}}]}", "cd048435aff7d656043bc0dc1fbff55fc465dcef": "{\"params\":{\"model\":\"o4-mini\",\"n\":1,\"num_candidates_per_completion\":1,\"insufficient_valids_behaviour\":\"retry\",\"temperature\":1.0,\"top_p\":null,\"max_tokens\":5000,\"thinking\":null,\"logprobs\":null,\"seed\":null,\"logit_bias\":null,\"stop\":null,\"unknown_kwargs\":{}},\"prompt\":{\"messages\":[{\"role\":\"system\",\"content\":\"Please solve this Codeforces problem by writing a Python solution. Return only the code and nothing else.\"},{\"role\":\"user\",\"content\":\"Problem: This is the hard version of the problem. The difference between the versions is that in this version, the constraints on $$$t$$$, $$$k$$$, and $$$m$$$ are higher. You can hack only if you solved all versions of this problem.\\n\\nA sequence $$$a$$$ of $$$n$$$ integers is called good if the following condition holds:\\n\\n- Let $$$\\\\text{cnt}_x$$$ be the number of occurrences of $$$x$$$ in sequence $$$a$$$. For all pairs $$$0 \\\\le i < j < m$$$, at least one of the following has to be true: $$$\\\\text{cnt}_i = 0$$$, $$$\\\\text{cnt}_j = 0$$$, or $$$\\\\text{cnt}_i \\\\le \\\\text{cnt}_j$$$. In other words, if both $$$i$$$ and $$$j$$$ are present in sequence $$$a$$$, then the number of occurrences of $$$i$$$ in $$$a$$$ is less than or equal to the number of occurrences of $$$j$$$ in $$$a$$$.\\n\\nYou are given integers $$$n$$$ and $$$m$$$. Calculate the value of the bitwise XOR of the median$$$^{\\\\text{\u2217}}$$$ of all good sequences $$$a$$$ of length $$$n$$$ with $$$0\\\\le a_i < m$$$.\\n\\nNote that the value of $$$n$$$ can be very large, so you are given its binary representation instead.\\n\\nTest Case Format:\\nEach test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\\\le t \\\\le 10^4$$$). The description of the test cases follows.\\n\\nThe first line of each test case contains two integers $$$k$$$ and $$$m$$$ ($$$1 \\\\le k \\\\le 2 \\\\cdot 10^5$$$, $$$1 \\\\le m \\\\le 10^9$$$)\u00a0\u2014 the number of bits in $$$n$$$ and the upper bound on the elements in sequence $$$a$$$.\\n\\nThe second line of each test case contains a binary string of length $$$k$$$\u00a0\u2014 the binary representation of $$$n$$$ with no leading zeros.\\n\\nIt is guaranteed that the sum of $$$k$$$ over all test cases does not exceed $$$2\\\\cdot 10^5$$$.\\n\\nFor each test case, output a single integer representing the bitwise XOR of the median of all good sequences $$$a$$$ of length $$$n$$$ where $$$0\\\\le a_i < m$$$.\\n\\nTest Inputs:\\n6\\r\\n2 3\\r\\n10\\r\\n2 3\\r\\n11\\r\\n5 1\\r\\n11101\\r\\n7 9\\r\\n1101011\\r\\n17 34\\r\\n11001010001010010\\r\\n1 1000000000\\r\\n1\\r\\n\\n\\nTest Outputs:\\n3\\r\\n2\\r\\n0\\r\\n8\\r\\n32\\r\\n0\\r\\n\"}]},\"responses\":[{\"model_id\":\"o4-mini\",\"completion\":\"\",\"stop_reason\":\"max_tokens\",\"cost\":0.0007029,\"audio_out\":null,\"duration\":41.03052520751953,\"api_duration\":40.93501114845276,\"logprobs\":null,\"safety_ratings\":null,\"recitation_retries\":null,\"api_failures\":2,\"batch_custom_id\":null,\"reasoning_content\":null,\"usage\":{\"input_tokens\":639,\"output_tokens\":5000,\"total_tokens\":5639,\"prompt_tokens_details\":{\"audio_tokens\":0,\"cached_tokens\":0},\"completion_tokens_details\":{\"accepted_prediction_tokens\":0,\"audio_tokens\":0,\"reasoning_tokens\":5000,\"rejected_prediction_tokens\":0}}}]}", "82ba36bac65cb907c178b5f5177e2c89c5ca6c87": "{\"params\":{\"model\":\"o4-mini\",\"n\":1,\"num_candidates_per_completion\":1,\"insufficient_valids_behaviour\":\"retry\",\"temperature\":1.0,\"top_p\":null,\"max_tokens\":5000,\"thinking\":null,\"logprobs\":null,\"seed\":null,\"logit_bias\":null,\"stop\":null,\"unknown_kwargs\":{}},\"prompt\":{\"messages\":[{\"role\":\"system\",\"content\":\"Please solve this Codeforces problem by writing a Python solution. Return only the code and nothing else.\"},{\"role\":\"user\",\"content\":\"Problem: This is the hard version of the problem. In this version, it is guaranteed that $$$r \\\\geq l+k-1$$$ for all queries.\\n\\nFor an arbitrary array $$$b$$$, Yunli can perform the following operation any number of times:\\n\\n- Select an index $$$i$$$. Set $$$b_i = x$$$ where $$$x$$$ is any integer she desires ($$$x$$$ is not limited to the interval $$$[1,n]$$$).\\n\\nDenote $$$f(b)$$$ as the minimum number of operations she needs to perform until there exists a consecutive subarray$$$^{\\\\text{\u2217}}$$$ of length at least $$$k$$$ in $$$b$$$.\\n\\nYunli is given an array $$$a$$$ of size $$$n$$$ and asks you $$$q$$$ queries. In each query, you must output $$$\\\\sum_{j=l+k-1}^{r} f([a_l, a_{l+1}, \\\\ldots, a_j])$$$.\\n\\nTest Case Format:\\nThe first line contains $$$t$$$ ($$$1 \\\\leq t \\\\leq 10^4$$$) \u2014 the number of test cases.\\n\\nThe first line of each test case contains three integers $$$n$$$, $$$k$$$, and $$$q$$$ ($$$1 \\\\leq k \\\\leq n \\\\leq 2 \\\\cdot 10^5$$$, $$$1 \\\\leq q \\\\leq 2 \\\\cdot 10^5$$$) \u2014 the length of the array, the length of the consecutive subarray, and the number of queries.\\n\\nThe following line contains $$$n$$$ integers $$$a_1, a_2, ..., a_n$$$ ($$$1 \\\\leq a_i \\\\leq n$$$).\\n\\nThe following $$$q$$$ lines contain two integers $$$l$$$ and $$$r$$$ ($$$1 \\\\leq l \\\\leq r \\\\leq n$$$, $$$r \\\\geq l+k-1$$$) \u2014 the bounds of the query.\\n\\nIt is guaranteed the sum of $$$n$$$ over all test cases does not exceed $$$2 \\\\cdot 10^5$$$ and the sum of $$$q$$$ over all test cases does not exceed $$$2 \\\\cdot 10^5$$$.\\n\\nOutput $$$\\\\sum_{j=l+k-1}^{r} f([a_l, a_{l+1}, \\\\ldots, a_j])$$$ for each query on a new line.\\n\\nTest Inputs:\\n3\\r\\n7 5 3\\r\\n1 2 3 2 1 2 3\\r\\n1 7\\r\\n2 7\\r\\n3 7\\r\\n8 4 2\\r\\n4 3 1 1 2 4 3 2\\r\\n3 6\\r\\n1 5\\r\\n5 4 2\\r\\n4 5 1 2 3\\r\\n1 4\\r\\n1 5\\r\\n\\n\\nTest Outputs:\\n6\\r\\n5\\r\\n2\\r\\n2\\r\\n5\\r\\n2\\r\\n3\\r\\n\"}]},\"responses\":[{\"model_id\":\"o4-mini\",\"completion\":\"\",\"stop_reason\":\"max_tokens\",\"cost\":0.0007359,\"audio_out\":null,\"duration\":44.96427011489868,\"api_duration\":44.86852502822876,\"logprobs\":null,\"safety_ratings\":null,\"recitation_retries\":null,\"api_failures\":2,\"batch_custom_id\":null,\"reasoning_content\":null,\"usage\":{\"input_tokens\":669,\"output_tokens\":5000,\"total_tokens\":5669,\"prompt_tokens_details\":{\"audio_tokens\":0,\"cached_tokens\":0},\"completion_tokens_details\":{\"accepted_prediction_tokens\":0,\"audio_tokens\":0,\"reasoning_tokens\":5000,\"rejected_prediction_tokens\":0}}}]}", "d831be6b9721abc866fdb4add8ebf9f48a988ef3": "{\"params\":{\"model\":\"o4-mini\",\"n\":1,\"num_candidates_per_completion\":1,\"insufficient_valids_behaviour\":\"retry\",\"temperature\":1.0,\"top_p\":null,\"max_tokens\":5000,\"thinking\":null,\"logprobs\":null,\"seed\":null,\"logit_bias\":null,\"stop\":null,\"unknown_kwargs\":{}},\"prompt\":{\"messages\":[{\"role\":\"system\",\"content\":\"Please solve this Codeforces problem by writing a Python solution. Return only the code and nothing else.\"},{\"role\":\"user\",\"content\":\"Problem: You are given an integer sequence $$$a_1, a_2, \\\\ldots, a_n$$$. Let $$$S$$$ be the set of all possible non-empty subsequences of $$$a$$$ without duplicate elements. Your goal is to find the longest sequence in $$$S$$$. If there are multiple of them, find the one that minimizes lexicographical order after multiplying terms at odd positions by $$$-1$$$.\\n\\nFor example, given $$$a = [3, 2, 3, 1]$$$, $$$S = \\\\{[1], [2], [3], [2, 1], [2, 3], [3, 1], [3, 2], [2, 3, 1], [3, 2, 1]\\\\}$$$. Then $$$[2, 3, 1]$$$ and $$$[3, 2, 1]$$$ would be the longest, and $$$[3, 2, 1]$$$ would be the answer since $$$[-3, 2, -1]$$$ is lexicographically smaller than $$$[-2, 3, -1]$$$.\\n\\nA sequence $$$c$$$ is a subsequence of a sequence $$$d$$$ if $$$c$$$ can be obtained from $$$d$$$ by the deletion of several (possibly, zero or all) elements.\\n\\nA sequence $$$c$$$ is lexicographically smaller than a sequence $$$d$$$ if and only if one of the following holds:\\n\\n- $$$c$$$ is a prefix of $$$d$$$, but $$$c \\\\ne d$$$;\\n- in the first position where $$$c$$$ and $$$d$$$ differ, the sequence $$$c$$$ has a smaller element than the corresponding element in $$$d$$$.\\n\\nTest Case Format:\\nEach test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\\\le t \\\\le 5 \\\\cdot 10^4$$$). The description of the test cases follows.\\n\\nThe first line of each test case contains an integer $$$n$$$ ($$$1 \\\\le n \\\\le 3 \\\\cdot 10^5$$$) \u2014 the length of $$$a$$$.\\n\\nThe second line of each test case contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$1 \\\\le a_i \\\\le n$$$) \u2014 the sequence $$$a$$$.\\n\\nIt is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$3 \\\\cdot 10^5$$$.\\n\\nFor each test case, output the answer in the following format:\\n\\nOutput an integer $$$m$$$ in the first line \u2014 the length of $$$b$$$.\\n\\nThen output $$$m$$$ integers $$$b_1, b_2, \\\\ldots, b_m$$$ in the second line \u2014 the sequence $$$b$$$.\\n\\nTest Inputs:\\n4\\r\\n4\\r\\n3 2 1 3\\r\\n4\\r\\n1 1 1 1\\r\\n9\\r\\n3 2 1 3 2 1 3 2 1\\r\\n1\\r\\n1\\r\\n\\n\\nTest Outputs:\\n3\\r\\n3 2 1\\r\\n1\\r\\n1\\r\\n3\\r\\n3 1 2\\r\\n1\\r\\n1\\r\\n\"}]},\"responses\":[{\"model_id\":\"o4-mini\",\"completion\":\"```python\\nimport sys\\nimport threading\\ndef main():\\n    import sys\\n    import bisect\\n    sys.setrecursionlimit(10**7)\\n    input = sys.stdin.readline\\n    t = int(input())\\n    for _ in range(t):\\n        n = int(input())\\n        a = list(map(int, input().split()))\\n        pos = {}\\n        for i, v in enumerate(a):\\n            pos.setdefault(v, []).append(i)\\n        last_occ = {v: lst[-1] for v, lst in pos.items()}\\n        # prepare heap for last occurrences\\n        import heapq\\n        heap = [(last_occ[v], v) for v in pos]\\n        heapq.heapify(heap)\\n        removed = set()\\n        # sorted linked list of values\\n        vals = sorted(pos.keys())\\n        nxt = {}\\n        prv = {}\\n        for i, v in enumerate(vals):\\n            prv[v] = vals[i-1] if i>0 else None\\n            nxt[v] = vals[i+1] if i+1<len(vals) else None\\n        head = vals[0]\\n        tail = vals[-1]\\n        # pointers for next occurrence > current_position\\n        idx = {v:0 for v in pos}\\n        curr_pos = -1\\n        m = len(vals)\\n        res = []\\n        for k in range(1, m+1):\\n            # get min1 and min2 from heap\\n            # pop stale\\n            while heap and heap[0][1] in removed:\\n                heapq.heappop(heap)\\n            # now heap[0] is min1\\n            min1_last, min1_val = heap[0]\\n            # get min2\\n            heapq.heappop(heap)\\n            while heap and heap[0][1] in removed:\\n                heapq.heappop(heap)\\n            if heap:\\n                min2_last, min2_val = heap[0]\\n            else:\\n                min2_last, min2_val = n, None\\n            heapq.heappush(heap, (min1_last, min1_val))\\n            # choose candidate\\n            if k & 1:\\n                # odd: descending\\n                v = tail\\n                while v is not None:\\n                    # find next occurrence\\n                    lst = pos[v]\\n                    j = idx[v]\\n                    while j < len(lst) and lst[j] <= curr_pos:\\n                        j += 1\\n                    idx[v] = j\\n                    if j < len(lst):\\n                        p_v = lst[j]\\n                        # limit\\n                        if v != min1_val:\\n                            lim = min1_last\\n                        else:\\n                            lim = min2_last\\n                        if p_v < lim:\\n                            break\\n                    v = prv[v]\\n                # v is chosen\\n            else:\\n                # even: ascending\\n                v = head\\n                while v is not None:\\n                    lst = pos[v]\\n                    j = idx[v]\\n                    while j < len(lst) and lst[j] <= curr_pos:\\n                        j += 1\\n                    idx[v] = j\\n                    if j < len(lst):\\n                        p_v = lst[j]\\n                        if v != min1_val:\\n                            lim = min1_last\\n                        else:\\n                            lim = min2_last\\n                        if p_v < lim:\\n                            break\\n                    v = nxt[v]\\n            # v selected\\n            res.append(v)\\n            curr_pos = pos[v][idx[v]]\\n            # remove v from linked list and from heap\\n            removed.add(v)\\n            # remove from linked list\\n            pv = prv[v]; nv = nxt[v]\\n            if pv is not None:\\n                nxt[pv] = nv\\n            else:\\n                head = nv\\n            if nv is not None:\\n                prv[nv] = pv\\n            else:\\n                tail = pv\\n        # output\\n        out = []\\n        out.append(str(len(res)))\\n        out.append(\\\" \\\".join(map(str,res)))\\n        sys.stdout.write(\\\"\\\\n\\\".join(out)+\\\"\\\\n\\\")\\nif __name__ == \\\"__main__\\\":\\n    main()\\n```\",\"stop_reason\":\"stop_sequence\",\"cost\":0.004490200000000001,\"audio_out\":null,\"duration\":39.05801010131836,\"api_duration\":38.956157207489014,\"logprobs\":null,\"safety_ratings\":null,\"recitation_retries\":null,\"api_failures\":1,\"batch_custom_id\":null,\"reasoning_content\":null,\"usage\":{\"input_tokens\":734,\"output_tokens\":4567,\"total_tokens\":5301,\"prompt_tokens_details\":{\"audio_tokens\":0,\"cached_tokens\":0},\"completion_tokens_details\":{\"accepted_prediction_tokens\":0,\"audio_tokens\":0,\"reasoning_tokens\":3712,\"rejected_prediction_tokens\":0}}}]}", "a9f058e0c6b5c8e6590894faf15cc8d8bfba107f": "{\"params\":{\"model\":\"o4-mini\",\"n\":1,\"num_candidates_per_completion\":1,\"insufficient_valids_behaviour\":\"retry\",\"temperature\":1.0,\"top_p\":null,\"max_tokens\":5000,\"thinking\":null,\"logprobs\":null,\"seed\":null,\"logit_bias\":null,\"stop\":null,\"unknown_kwargs\":{}},\"prompt\":{\"messages\":[{\"role\":\"system\",\"content\":\"Please solve this Codeforces problem by writing a Python solution. Return only the code and nothing else.\"},{\"role\":\"user\",\"content\":\"Problem: You are given an array $$$a$$$ of length $$$n$$$ and an integer $$$k$$$. You are also given a binary array $$$b$$$ of length $$$n$$$.\\n\\nYou can perform the following operation at most $$$k$$$ times:\\n\\n- Select an index $$$i$$$ ($$$1 \\\\leq i \\\\leq n$$$) such that $$$b_i = 1$$$. Set $$$a_i = a_i + 1$$$ (i.e., increase $$$a_i$$$ by $$$1$$$).\\n\\nYour score is defined to be $$$\\\\max\\\\limits_{i = 1}^{n} \\\\left( a_i + \\\\operatorname{median}(c_i) \\\\right)$$$, where $$$c_i$$$ denotes the array of length $$$n-1$$$ that you get by deleting $$$a_i$$$ from $$$a$$$. In other words, your score is the maximum value of $$$a_i + \\\\operatorname{median}(c_i)$$$ over all $$$i$$$ from $$$1$$$ to $$$n$$$.\\n\\nFind the maximum score that you can achieve if you perform the operations optimally.\\n\\nFor an arbitrary array $$$p$$$, $$$\\\\operatorname{median}(p)$$$ is defined as the $$$\\\\left\\\\lfloor \\\\frac{|p|+1}{2} \\\\right\\\\rfloor$$$-th smallest element of $$$p$$$. For example, $$$\\\\operatorname{median} \\\\left( [3,2,1,3] \\\\right) = 2$$$ and $$$\\\\operatorname{median} \\\\left( [6,2,4,5,1] \\\\right) = 4$$$.\\n\\nTest Case Format:\\nThe first line contains an integer $$$t$$$ ($$$1 \\\\leq t \\\\leq 10^4$$$)\u00a0\u2014 the number of test cases.\\n\\nEach test case begins with two integers $$$n$$$ and $$$k$$$ ($$$2 \\\\leq n \\\\leq 2 \\\\cdot 10^5$$$, $$$0 \\\\leq k \\\\leq 10^9$$$)\u00a0\u2014 the length of the $$$a$$$ and the number of operations you can perform.\\n\\nThe following line contains $$$n$$$ space separated integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$1 \\\\leq a_i \\\\leq 10^9$$$)\u00a0\u2014 denoting the array $$$a$$$.\\n\\nThe following line contains $$$n$$$ space separated integers $$$b_1, b_2, \\\\ldots, b_n$$$ ($$$b_i$$$ is $$$0$$$ or $$$1$$$)\u00a0\u2014 denoting the array $$$b$$$.\\n\\nIt is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$2 \\\\cdot 10^5$$$.\\n\\nFor each test case, output the maximum value of score you can get on a new line.\\n\\nTest Inputs:\\n8\\r\\n2 10\\r\\n3 3\\r\\n1 1\\r\\n3 10\\r\\n3 3 3\\r\\n0 0 0\\r\\n4 4\\r\\n2 1 5 1\\r\\n0 1 0 1\\r\\n5 4\\r\\n7 5 2 5 4\\r\\n0 0 1 0 1\\r\\n5 1\\r\\n5 15 15 2 11\\r\\n1 0 0 1 1\\r\\n5 2\\r\\n10 11 4 10 15\\r\\n1 1 0 1 0\\r\\n4 4\\r\\n1 1 2 5\\r\\n1 1 0 0\\r\\n2 1000000000\\r\\n1000000000 1000000000\\r\\n1 1\\r\\n\\n\\nTest Outputs:\\n16\\r\\n6\\r\\n8\\r\\n13\\r\\n21\\r\\n26\\r\\n8\\r\\n3000000000\\r\\n\"}]},\"responses\":[{\"model_id\":\"o4-mini\",\"completion\":\"\",\"stop_reason\":\"max_tokens\",\"cost\":0.0009394000000000001,\"audio_out\":null,\"duration\":37.10040307044983,\"api_duration\":37.010759115219116,\"logprobs\":null,\"safety_ratings\":null,\"recitation_retries\":null,\"api_failures\":2,\"batch_custom_id\":null,\"reasoning_content\":null,\"usage\":{\"input_tokens\":854,\"output_tokens\":5000,\"total_tokens\":5854,\"prompt_tokens_details\":{\"audio_tokens\":0,\"cached_tokens\":0},\"completion_tokens_details\":{\"accepted_prediction_tokens\":0,\"audio_tokens\":0,\"reasoning_tokens\":5000,\"rejected_prediction_tokens\":0}}}]}"}